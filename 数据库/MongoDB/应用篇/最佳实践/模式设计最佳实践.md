# MongoDB 模式设计最佳实践

**MongoDB是无模式的，开发人员必须设计集合和索引以适应这一事实。**

## 早期和常见索引

使用MMS、Compass GUI或早期的日志和索引识别常见查询模式，并在项目开始时使用尽可能多的索引。

## 消除不必要的索引
这与上面的设计感觉好像是一点自相矛盾的味道，其实不然，它指的是 **监控数据库以更改查询模式并删除未使用的索引**。索引将消费RAM和I/O，因为它需要与数据库中的文档一起存储和更新。使用`聚合管道`和`$ indexStats`，开发人员可以识别很少用的索引并消灭他们。

## 使用复合索引而不是索引交集

使用多个谓词（例如 A and B, C or D and E 等）查询，`大多数情况下使用单个复合索引比使用多个简单索引效果要好`。此外，`复合索引将按字段排序其数据，开发人员可以在查询时使用此优势`。字段 A、B、C的索引将用于查询A、（A，B）、（A，B，C），但不用于查询（B，C）或（C）。

## 低选择性索引
例如：对性别字段建立索引时，将在统计上仍然返回一般的文档，而如果对姓氏字段建立索引，则将只返回少数具备相同姓氏的文档。

## 使用正则表达式

由于索引按值排序，因此使用带有前导通配符（即/.*BASE/）的正则表达式进行搜索