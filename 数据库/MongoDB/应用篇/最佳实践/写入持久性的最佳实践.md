# MongoDB 写入持久性最佳实践

在WiredTiger存储引擎中，默认设置是在最后一个检查点之后每 `隔60秒` 或在 `写入数据达到2GB之后` 将数据冲刷(Flush)到磁盘。可以使用 `--wiredTigerCheckpointDelaySecs` 命令行选项更改此设置。

在MMAPv1中，数据文件 `每隔60秒` 冲刷一次。当然，这也可以使用 `--syncDelay` 命令行选项进行更改。

* 采用WiredTiger存储引擎时，可以使用`XFS文件系统`实现多磁盘的一致性快照。
* 关闭数据卷中的`atime`和`diratime`。
* 请确保有足够的**交换空间**，通常是内存大小的**两倍**。
* 如果在虚拟环境中运行，则可以使用`NOOP调度程序`。
* 将**文件描述符**限制提高到数万
* 禁用透明的大页面，启用**标准4K虚拟机页面**。
* 写入安全性应该至少使用Journaling日志记录下来。
* SSD预读默认值应该设置为16个块，HDD应为32个块。
* **在BIOS中关闭NUMA**
* 使用 `RAID 10`
* 使用`NTP`在主机之间同步时间，**尤其在分片环境中**。
